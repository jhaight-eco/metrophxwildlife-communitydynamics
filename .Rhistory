axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
)
plot.cw
ggsave("./figures/richness_actual_vs_urb_1warmdry.png",
plot.wd,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
ggsave("./figures/richness_actual_vs_urb_2warmwet.png",
plot.ww,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
ggsave("./figures/richness_actual_vs_urb_3coolwet.png",
plot.cw,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
plot.all <- ggplot() +
geom_pointrange(data = data, aes(x = imp1km, y = rich_wd_mean, ymin = rich_wd_2_5, ymax = rich_wd_97_5),
col = "#ff8701", fatten = 1, position = "jitter")+
stat_smooth(data = data, aes(x = imp1km, y = rich_wd_mean), fill = "#f2ff0d", col = "#ff8701",
method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
geom_pointrange(data = data, aes(x = imp1km, y = rich_ww_mean, ymin = rich_ww_2_5, ymax = rich_ww_97_5),
col = "#d10073", fatten = 1)+
stat_smooth(data = data, aes(x = imp1km, y = rich_ww_mean), fill = "#ff23c1", col = "#d10073",
method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
geom_pointrange(data = data, aes(x = imp1km, y = rich_cw_mean, ymin = rich_cw_2_5, ymax = rich_cw_97_5),
col = "#2f3ca3", fatten = 1)+
stat_smooth(data = data, aes(x = imp1km, y = rich_cw_mean), fill = "#7291fb", col = "#2f3ca3",
method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
#geom_smooth(data = preds.sr.urb1, aes(x = impervious, y = median, ymin = lower95, ymax = upper95,),
#            fill = "#7291fb", color = "#2f3ca3", se = FALSE, linetype = "dashed")+   # predict
theme_bw() +
coord_cartesian(xlim=c(0, max(data$imp1km)), ylim=c(0,16))+
labs(x = "Urbanization \n(% Impervious Surface)", y = "Species Richness")  +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
)
plot.all
ggsave("./figures/richness_actual_vs_urb_allseasons.png",
plot.all,
width = 6,
height = 5,
units = "in",
dpi = 300)
##### Plot Predicted Richness across Hypothetical Gradients  #####
##### Urbanization vs. Species Richness Predictions by Season #####
# Predicted species richness
palette_ggdemo(wildflower)
plot.wd <- ggplot() +
theme_bw(base_size = 11) +
#geom_errorbar(data = data, aes(x = imp1km, y = rich_wd_mean, ymin = rich_wd_2_5, ymax = rich_wd_97_5),
#              lwd = 0.3, alpha = 0.3) +
#geom_point(data = data, aes(x = imp1km, y = rich_wd_mean, ymin = rich_wd_2_5, ymax = rich_wd_97_5))+
geom_ribbon(data = preds.sr.urb1, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.5,
fill = "#f2ff0d") +
geom_smooth(data = preds.sr.urb1, aes(x = impervious, y = median, ymin = lower95, ymax = upper95,),
fill = "#f2ff0d", color = "#ff8701", se = FALSE, size = 0.5, linetype = "dashed")+
#stat_smooth(data = data, aes(x = imp1km, y = rich_wd_mean), fill = "#f2ff0d", col = "#ff8701",
#            method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
coord_cartesian(xlim=c(0, max(data$imp1km)), ylim=c(0,18))+
labs(x = "Urbanization \n(% Impervious Surface)", y = "Species Richness")  +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
)
plot.wd
# 32, 54, 16, fill/color
plot.ww <- ggplot() +
theme_bw() +
geom_ribbon(data = preds.sr.urb2, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.5,
fill = "#ff23c1") + #"#ff23c1"
geom_smooth(data = preds.sr.urb2, aes(x = impervious, y = median, ymin = lower95, ymax = upper95),
fill = "#ff23c1", col = "#d10073", se = FALSE, size = 0.5, linetype = "dashed")+
#stat_smooth(data = data, aes(x = imp1km, y = rich_wd_mean), fill = "#ff23c1", col = "#d10073",
#            method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
coord_cartesian(xlim=c(0, max(data$imp1km)), ylim=c(0,18))+
labs(x = "Urbanization \n(% Impervious Surface)", y = "Species Richness")  +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
)
plot.ww
plot.cw <- ggplot() +
geom_ribbon(data = preds.sr.urb3, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.5,
fill = "#7291fb") +
geom_smooth(data = preds.sr.urb3, aes(x = impervious, y = median, ymin = lower95, ymax = upper95),
fill = "#7291fb", color = "#2f3ca3", se = FALSE, size = 0.5, linetype = "dashed")+
#stat_smooth(data = data, aes(x = imp1km, y = rich_wd_mean), fill = "#7291fb", col = "#2f3ca3",
#            method = "lm", formula = y ~ x + I(x^2), se = FALSE, size = 0.5) +
theme_bw() +
coord_cartesian(xlim=c(0, max(data$imp1km)), ylim=c(0,18))+
labs(x = "Urbanization \n(% Impervious Surface)", y = "Species Richness")  +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
)
plot.cw
ggsave("./figures/richness_pred_vs_urb_1warmdry.png",
plot.wd,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
ggsave("./figures/richness_pred_vs_urb_2warmwet.png",
plot.ww,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
ggsave("./figures/richness_pred_vs_urb_3coolwet.png",
plot.cw,
width = 3,
height = 2.5,
units = "in",
dpi = 300)
plot.all <- ggplot() +
theme_bw(base_size = 11) +
geom_ribbon(data = preds.sr.urb1, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.3,
fill = "#f2ff0d") +
geom_smooth(data = preds.sr.urb1, aes(x = impervious, y = median, ymin = lower95, ymax = upper95,),
fill = "#f2ff0d", color = "#ff8701", se = FALSE, linetype = "solid")+
geom_ribbon(data = preds.sr.urb2, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.3,
fill = "#ff23c1") +
geom_smooth(data = preds.sr.urb2, aes(x = impervious, y = median, ymin = lower95, ymax = upper95),
fill = "#ff23c1", col = "#d10073", se = FALSE, linetype = "dotted")+
geom_ribbon(data = preds.sr.urb3, aes(x = impervious, y = median, ymin = lower95, ymax = upper95), alpha = 0.3,
fill = "#7291fb") +
geom_smooth(data = preds.sr.urb3, aes(x = impervious, y = median, ymin = lower95, ymax = upper95),
fill = "#7291fb", color = "#2f3ca3",  se = FALSE, linetype = "dashed")+
coord_cartesian(xlim=c(0, max(data$imp1km)), ylim=c(0,18))+
labs(x = "Urbanization \n(% Impervious Surface)", y = "Species Richness")  +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold", size = 12),
axis.title.y = element_text(face = "bold", size = 12),
)
plot.all
ggsave("./figures/richness_pred_vs_urb_allseasons.png",
plot.all,
width = 6,
height = 5,
units = "in",
dpi = 300)
#### Setup ####
rm(list=ls()) # clear the environment
gc()
set.seed(4321)
# Set working directory
setwd("~/GitHub/metrophxwildlife-communitydynamics")
# Load necessary packages
#library(dplyr)
library(tidyverse)
# modeling packages
library(jagsUI)
library(runjags)
# visualization packages
library(flextable)
library(ggplot2)
library(gghighlight)
library(viridis)
library(RColorBrewer)
library(lterpalettefinder)
library(nationalparkcolors)
library(png)
# import some color palettes
load("./data/model_inputs/arizonapalettes.RData")
##### Import Data #####
# all the data input into the models
load("./data/model_inputs/ModelInputData_DCM.RData")
# The main dataset containing all the site and regional covariates
# and summarized community composition parameters
data <- read.csv("./data/model_outputs/data_PhoenixCommDynamics.csv")
# Community-average dynamic use parameters (occupancy, persistence, and colonization)
# predicted across each environmental covariate with all others held constant
data.pred.comm <- read.csv("./data/model_outputs/predictions_commparams.csv")
# Species-level parameter predictions based on the actual trait values of the 22 species
data.pred.sp <- read.csv("./data/model_outputs/predictions_22sp_urban.csv")
# Species-level parameter predictions based on three idealized trait levels (with the other trait held constant)
data.pred.bm <- read.csv("./data/model_outputs/predictions_ideal_3spp_size.csv")
data.pred.di <- read.csv("./data/model_outputs/predictions_ideal_3spp_diet.csv")
# To plot without the 'moderate' trait species, remove those from the predictions dataset
data.pred.bm <- data.pred.bm %>% filter(species != "sp2")
data.pred.di <- data.pred.di %>% filter(species != "sp2")
load("./data/model_inputs/ModelInputData_DCM.RData")
# The main dataset containing all the site and regional covariates
# and summarized community composition parameters
data <- read.csv("./data/model_outputs/data_PhoenixCommDynamics.csv")
# Community-average dynamic use parameters (occupancy, persistence, and colonization)
# predicted across each environmental covariate with all others held constant
data.pred.comm <- read.csv("./data/model_outputs/predictions_commparams.csv")
# Species-level parameter predictions based on the actual trait values of the 22 species
data.pred.sp <- read.csv("./data/model_outputs/predictions_22sp_urban.csv")
# Species-level parameter predictions based on three idealized trait levels (with the other trait held constant)
data.pred.bm <- read.csv("./data/model_outputs/predictions_ideal_3spp_size.csv")
data.pred.di <- read.csv("./data/model_outputs/predictions_ideal_3spp_diet.csv")
# To plot the trait variation without the 'moderate' trait species, remove those from the predictions dataset
data.pred.bm <- data.pred.bm %>% filter(species != "sp2")
data.pred.di <- data.pred.di %>% filter(species != "sp2")
#### Plot Community-average Predictions
# Plot across the gradient of urbanization
plot.psi.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = psi_urb_med)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = psi_urb_low95, ymax = psi_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(breaks = c(0.00, 0.25, 0.50, 0.75)) +
coord_cartesian(ylim = c(0,0.75)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Occupancy") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.psi.urb  # substantial relationship
plot.phi.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = phi_urb_med)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = phi_urb_low95, ymax = phi_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,1)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Persistence") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.phi.urb
plot.gamma.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = gamma_urb)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = gamma_urb_low95, ymax = gamma_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,0.25)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Colonization") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.gamma.urb
ggsave("./figures/comm_urb_vs_1psi.png",
plot.psi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_2phi.png",
plot.phi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_3gamma.png",
plot.gamma.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
#### Plot Community-average Predictions
# Plot across the gradient of urbanization
plot.psi.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = psi_urb_med)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = psi_urb_low95, ymax = psi_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(breaks = c(0.00, 0.25, 0.50, 0.75)) +
coord_cartesian(ylim = c(0,0.75)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Occupancy") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.psi.urb  # substantial relationship
plot.phi.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = phi_urb_med)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = phi_urb_low95, ymax = phi_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,1)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Persistence") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.phi.urb
plot.gamma.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = gamma_urb)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = gamma_urb_low95, ymax = gamma_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,0.25)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Colonization") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
library(png)
library(scales)
plot.phi.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = phi_urb_med)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = phi_urb_low95, ymax = phi_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,1)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Persistence") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.phi.urb
plot.gamma.urb <- ggplot(data = data.pred.comm, aes(x = impervious, y = gamma_urb)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = gamma_urb_low95, ymax = gamma_urb_high95), fill = "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color = "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,0.25)) +
labs(x = "Urbanization \n(% Impervious Surface)", y = "Colonization") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.gamma.urb
ggsave("./figures/comm_urb_vs_1psi.png",
plot.psi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_2phi.png",
plot.phi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_3gamma.png",
plot.gamma.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_1psi.png",
plot.psi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_2phi.png",
plot.phi.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_urb_vs_3gamma.png",
plot.gamma.urb,
width = 4,
height = 4,
units = "in",
dpi = 300)
##### Across a gradient of patch diversity #####
plot.psi.het <- ggplot(data = data.pred.comm, aes(x = het, y = psi_het)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = psi_het_low95, ymax = psi_het_high95), fill =  "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color =  "black")+
#geom_point(color = "gray4")+
scale_y_continuous(breaks = c(0.00, 0.25, 0.50, 0.75)) +
coord_cartesian(ylim = c(0,0.8)) +
labs(x = "Patch Diversity \n(Shannon Diversity Index)", y = "Occupancy") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.psi.het
plot.phi.het <- ggplot(data = data.pred.comm, aes(x = het, y = phi_het)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = phi_het_low95, ymax = phi_het_high95), fill =  "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color =  "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,1)) +
labs(x = "Patch Diversity \n(Shannon Diversity Index)", y = "Persistence") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.phi.het
plot.gamma.het <- ggplot(data = data.pred.comm, aes(x = het, y = gamma_het)) +
theme_classic(base_size = 20)+
geom_ribbon(aes(ymin = gamma_het_low95, ymax = gamma_het_high95), fill =  "gray40", alpha = 0.5) +
geom_smooth(se = FALSE, color =  "black")+
#geom_point(color = "gray4")+
scale_y_continuous(labels = label_number(accuracy = 0.01)) +
coord_cartesian(ylim = c(0,0.25)) +
labs(x = "Patch Diversity \n(Shannon Diversity Index)", y = "Colonization") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18)
)
plot.gamma.het
ggsave("./figures/comm_het_vs_1psi.png",
plot.psi.het,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_het_vs_2phi.png",
plot.phi.het,
width = 4,
height = 4,
units = "in",
dpi = 300)
ggsave("./figures/comm_het_vs_3gamma.png",
plot.gamma.het,
width = 4,
height = 4,
units = "in",
dpi = 300)
##### Across a gradient of vegetation greenness #####
# Colonization
plot.gamma.veg <- ggplot(data = data.pred.bm, aes(x = veg, y = gamma_veg_med, ymin = gamma_veg_low95, ymax = gamma_veg_high95, group = logmass, fill = logmass, col = logmass)) +
geom_smooth(lwd = 1.5, col = "black", se = FALSE) +
geom_smooth(lwd = 0.8, se = FALSE) +
theme_classic(base_size = 20) +
geom_ribbon(alpha = 0.4, color = NA) +
scale_color_viridis(option = "plasma", direction = -1, begin = 0.25,
trans = "log10", breaks = log10(c(0.5, 1, 5, 20)*1000), labels = c("0.5", "1", "5", "20")) +
scale_fill_viridis(option = "plasma", direction = -1, begin = 0.25,
trans = "log10", breaks = log10(c(0.5, 1, 5, 20)*1000), labels = c("0.5", "1", "5", "20")) +
coord_cartesian(ylim = c(0, 0.8)) +
labs(x = "Vegetation Greenness \n(NDVI)", y = "Colonization", color = "Body \nMass \n(kg)") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
legend.position = "none",
legend.title = element_text(face = "bold"),
legend.text = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18))
plot.gamma.veg
ggsave("./figures/traitvarideal_vegsize_vs_3colonization.png",
plot.gamma.veg,
width = 4,
height = 4,
units = "in",
dpi = 300)
# Colonization
plot.gamma.veg <- ggplot(data = data.pred.bm, aes(x = veg, y = gamma_veg_med, ymin = gamma_veg_low95, ymax = gamma_veg_high95, group = logmass, fill = logmass, col = logmass)) +
geom_smooth(lwd = 1.5, col = "black", se = FALSE) +
geom_smooth(lwd = 0.8, se = FALSE) +
theme_classic(base_size = 20) +
geom_ribbon(alpha = 0.4, color = NA) +
scale_color_viridis(option = "plasma", direction = -1, begin = 0.25,
trans = "log10", breaks = log10(c(0.5, 1, 5, 20)*1000), labels = c("0.5", "1", "5", "20")) +
scale_fill_viridis(option = "plasma", direction = -1, begin = 0.25,
trans = "log10", breaks = log10(c(0.5, 1, 5, 20)*1000), labels = c("0.5", "1", "5", "20")) +
coord_cartesian(ylim = c(0, 1)) +
labs(x = "Vegetation Greenness \n(NDVI)", y = "Colonization", color = "Body \nMass \n(kg)") +
theme(axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
legend.position = "none",
legend.title = element_text(face = "bold"),
legend.text = element_text(face = "bold"),
axis.ticks = element_blank(),
axis.title.x = element_text(face = "bold", size = 18),
axis.title.y = element_text(face = "bold", size = 18))
plot.gamma.veg
ggsave("./figures/traitvarideal_vegsize_vs_3colonization.png",
plot.gamma.veg,
width = 4,
height = 4,
units = "in",
dpi = 300)
